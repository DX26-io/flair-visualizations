<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <title>DEMO</title>
    <link rel="stylesheet" type="text/css" href="./bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="‎⁨./node_modules⁩/@fortawesome⁩/fontawesome-free/css/fontawesome.min.css⁩">
  </head>

  <body>
    <div id="header" style="text-align:center; width:100%; margin: 0 auto; display:block; padding-top:5px; height:60px; margin-bottom:35px;">
        <h1 style="color:#777; font-weight:100;">PIE</h1>
    </div>
    <div style="position: relative;">
        <svg id="pie" width="1260" height="540"/>
        <div id="tooltip"></div>
    </div>

    <script src="./bower_components/bootstrap/dist/js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="./bower_components/jquery/dist/jquery.min.js"></script>
    <script src="./bower_components/d3/d3.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="./dist/main.bundle.js"></script>
    <script type="text/javascript" charset="utf-8">
        /* Global variable accessible from anywhere */
        var cities = ['Kathmandu', 'Delhi', 'Detroit', 'London', 'Washington', 'Berlin', 'Perth', 'Ottawa'];

        function shuffleFn(a) {
            var j, x, i;
            for(i = a.length - 1; i > 0; i--) {
                j = Math.floor(Math.random() * (i + 1));
                x = a[i];
                a[i] = a[j];
                a[j] = x;
            }
            return a;
        }

        function fixedFn(a) {
            var val;

            for(var i = 0; i < a.length; i++) {
                val = Math.floor(Math.random() * (i + 1) * 100) % 7;
                if(!val) {
                    a.splice(i, 1);
                }
            }

            return a;
        }

        function randomData(shuffle, fixed) {
            var clone = jQuery.extend(true, [], cities); // deep copy

            if(shuffle) {
                shuffleFn(clone);
            }

            if(!fixed) {
                fixedFn(clone);
            }

            return clone.map(function(city) {
                return {
                    city: city,
                    cost: Math.floor(Math.random() * (1000 - 10 + 1) + 10)
                }
            });
        }

        var config = {
            dimension: ['city'],
            measure: ['cost'],
            legend: true, // true|false
            legendPosition: 'left', // top|bottom|right|left
            value: 'label', // label|value|percentage
            valueAsArc: true, // true|false
            valuePosition: 'outside' // inside|outside
        }

        var chart = flairVisualizations.pie()
            .config(config)
            // .sort(UTIL.DESCENDING)
            .tooltip(true);

        d3.select('#pie')
            .datum(randomData(false, true))
            .call(chart);

        // setInterval(function() { chart.update(randomData(false, false)) }, 1000);
    </script>
  </body>
</html>
